<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Clean Park ‚Äî Recycling Game</title>
  <meta name="description" content="Interactive, kid-friendly recycling game to teach basic English vocabulary about recycling. Responsive and mobile-first." />
  <style>
    :root{
      --bg-dark: #031026;
      --panel:#071426;
      --muted: #c6d7e6;
      --accent: #ffd166;
      --accent-2: #06d6a0;
      --accent-3: #4cc9f0;
      --glass: rgba(255,255,255,0.04);
      --radius:14px; --shadow: 0 10px 30px rgba(2,8,23,0.6);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg-dark);
      color:var(--muted);
      -webkit-font-smoothing:antialiased;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:20px;
      overflow-x:hidden;
      overflow-y:auto; /* allow vertical scroll on mobile */
      -webkit-overflow-scrolling: touch;
    }

    .sky{position:fixed; inset:0; z-index:0; pointer-events:none}
    .star{position:absolute; width:3px; height:3px; background:rgba(255,255,255,0.9); border-radius:50%; opacity:0.9}
    .rocket{position:fixed; width:64px; height:64px; z-index:2; pointer-events:none; transform-origin:center;}

    .app{position:relative; z-index:3; width:100%; max-width:1100px}
    header{display:flex; gap:16px; align-items:center; margin-bottom:18px}
    .logo{width:68px; height:68px; border-radius:14px; background:linear-gradient(135deg,var(--accent),var(--accent-2)); display:flex; align-items:center; justify-content:center; color:#042a2b; font-weight:800; box-shadow:var(--shadow);}
    h1{font-size:22px;margin:0; color:var(--accent-3)}
    p.lead{margin:0;color:var(--muted); font-size:14px}

    main{display:grid; grid-template-columns: 1fr 360px; gap:18px}

    .board{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:18px; padding:18px; box-shadow:var(--shadow); border:1px solid rgba(255,255,255,0.03)}
    .section-title{display:flex; justify-content:space-between; align-items:center; gap:8px}
    .subtitle{color:var(--muted); font-size:13px}

    .workspace{margin-top:12px; min-height:420px; border-radius:12px; padding:14px; position:relative}

    .items{display:flex; flex-wrap:wrap; gap:12px}
    .item{width:120px; border-radius:14px; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; font-size:44px; touch-action:none; border:1px solid rgba(255,255,255,0.04); box-shadow: 0 8px 20px rgba(2,8,23,0.45); user-select:none; padding:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));}
    .item .emoji{font-size:46px}
    .item .label{display:block; font-size:13px; color:var(--muted); margin-top:8px; text-align:center}
    .item .playBtn{margin-top:8px; background:linear-gradient(90deg,var(--accent),var(--accent-2)); border:none; color:#072a2a; padding:6px 10px; border-radius:10px; font-weight:700; cursor:pointer}

    .bins{display:grid; grid-template-columns: repeat(4,1fr); gap:12px; margin-top:18px}
    .bin{min-height:120px; border-radius:12px; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:12px; border:2px dashed rgba(255,255,255,0.03); transition:all .18s; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));}
    .bin.highlight{border-style:solid; box-shadow:0 10px 25px rgba(8,40,50,0.5)}
    .bin .title{font-weight:800; color:var(--accent-3);}
    .bin .hint{font-size:12px; color:var(--muted)}

    .panel{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:18px; padding:18px; box-shadow: var(--shadow); height:100%}
    .score{font-size:20px; font-weight:800; color:var(--accent)}
    .btn{background:linear-gradient(90deg,var(--accent-2),var(--accent-3)); border:none; color:#032526; padding:9px 12px; border-radius:10px; cursor:pointer; font-weight:700}
    .btn.secondary{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted)}
    footer{margin-top:14px; font-size:12px; color:var(--muted)}

    @media (max-width:1000px){main{grid-template-columns:1fr;} .panel{order:2}}
  </style>
</head>
<body>
  <div class="sky" id="sky"></div>
  <img src="" alt="rocket" class="rocket" id="rocket" style="display:none">

  <div class="app">
    <header>
      <div class="logo">CP</div>
      <div>
        <h1 id="title">Clean Park ‚Äî Recycling Game</h1>
        <p id="lead" class="lead">Fun, colorful and safe way to learn recycling words in English.</p>
      </div>
    </header>

    <main>
      <section class="board" aria-label="Game board">
        <div class="section-title">
          <div>
            <strong id="gameTitle">Game 1 ‚Äî Sort & Learn</strong>
            <div id="instructions" class="subtitle">Drag each item to the correct recycling bin. Say the new word out loud!</div>
          </div>
          <div class="subtitle">Vocabulary: <span id="vocabList">plastic bottle, paper, banana peel, can, glass</span></div>
        </div>

        <div class="workspace" id="workspace">
          <div class="items" id="items"></div>

          <div class="bins" id="bins" aria-hidden="false">
            <div class="bin" data-type="plastics" id="bin-plastics">
              <div class="title" id="bin-plastics-label">Plastics</div>
              <div class="hint" id="bin-plastics-hint">bottles, packaging</div>
            </div>
            <div class="bin" data-type="paper" id="bin-paper">
              <div class="title" id="bin-paper-label">Paper</div>
              <div class="hint" id="bin-paper-hint">cards, paper</div>
            </div>
            <div class="bin" data-type="organic" id="bin-organic">
              <div class="title" id="bin-organic-label">Organic</div>
              <div class="hint" id="bin-organic-hint">food, peel</div>
            </div>
            <div class="bin" data-type="metal" id="bin-metal">
              <div class="title" id="bin-metal-label">Metal</div>
              <div class="hint" id="bin-metal-hint">cans, tins</div>
            </div>
            <div class="bin" data-type="glass" id="bin-glass">
    <div class="title" id="bin-glass-label">Glass</div>
    <div class="hint" id="bin-glass-hint">bottles, jars</div>
  </div>
          </div>
        </div>

        <div style="display:flex; gap:8px; margin-top:12px; align-items:center">
          <button id="resetBtn" class="btn secondary">Reset</button>
          <button id="voiceBtn" class="btn">Play Word</button>
          <div style="margin-left:auto" class="subtitle">Translation: <label style="margin-left:8px"><input type="checkbox" id="transToggle"> <span id="transLabel" style="margin-left:8px">Portugu√™s</span></label></div>
        </div>

      </section>

      <aside class="panel">
        <div style="display:flex; align-items:center; justify-content:space-between">
          <div>
            <div class="score" id="score">Score: 0</div>
            <div class="subtitle">Found: <span id="foundCount">0</span> / <span id="totalItems">0</span></div>
          </div>
          <div style="text-align:right">
            <div style="font-size:12px; color:var(--muted)" id="levelLabel">Level</div>
            <div style="font-weight:800">Beginner</div>
          </div>
        </div>

        <div style="margin-top:14px">
          <strong id="quizTitle">Mini-Quiz</strong>
          <p class="subtitle" id="quizSubtitle">Choose the correct word for the image shown.</p>
          <div id="quizCard" style="margin-top:10px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:12px;">
            <div id="quizImage" style="font-size:48px; text-align:center">üçå</div>
            <div style="display:flex; gap:8px; margin-top:10px;">
              <button class="btn secondary quizBtn">banana</button>
              <button class="btn secondary quizBtn">paper</button>
              <button class="btn secondary quizBtn">plastic</button>
            </div>
            <div id="quizFeedback" style="margin-top:8px;color:var(--muted); font-size:13px"></div>
          </div>
        </div>

        <div style="margin-top:16px">
          <strong id="tipsTitle">Tips for parents / teachers</strong>
          <ul style="color:var(--muted); font-size:13px">
            <li id="tip1">Repeat the words out loud with the child.</li>
            <li id="tip2">Give a small reward for each correct sort.</li>
            <li id="tip3">Play the "Play Word" button and ask them to point.</li>
          </ul>
        </div>

        <footer>
          <div class="subtitle">Designed for kids ‚Äî clean UI, large touch targets.</div>
        </footer>
      </aside>
    <div class="text-center">
      <button onclick="checkRecipeAnswer()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-xl shadow">Check Answer</button>
      <p id="feedback" class="mt-4"></p>
      <a href="ingles.html" class="inline-block mt-6 text-blue-800 underline">&larr; Back to Home</a>
    </div>
    </main>
  </div>

  <script>
    // STARFIELD - reduced for performance
    const sky = document.getElementById('sky');
    const STAR_COUNT = 20; // reduced from 60
    for(let i=0;i<STAR_COUNT;i++){
      const s = document.createElement('div'); s.className='star';
      const size = Math.random()*3 + 1; s.style.width = size+'px'; s.style.height = size+'px';
      s.style.left = Math.random()*100 + '%'; s.style.top = Math.random()*100 + '%';
      s.style.opacity = 0.15 + Math.random()*0.85;
      sky.appendChild(s);
      const dur = 8 + Math.random()*12;
      s.animate([{transform:'translateY(0px)'},{transform:'translateY(40px)'}], {duration: dur*1000, iterations: Infinity, direction:'alternate', easing:'linear'});
    }

    // rocket svg and flight - fixed template string
    const rocket = document.getElementById('rocket');
    rocket.src = 'data:image/svg+xml;utf8,' + encodeURIComponent(`
<svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
  <g>
    <ellipse cx="32" cy="50" rx="12" ry="4" fill="#ffba08" opacity="0.25"/>
    <path d="M32 4c6 0 12 6 12 12 0 6-12 18-12 18s-12-12-12-18c0-6 6-12 12-12z" fill="#ef476f"/>
    <rect x="28" y="18" width="8" height="12" rx="2" fill="#ffd166"/>
    <circle cx="32" cy="24" r="2" fill="#118ab2"/>
  </g>
</svg>`);
    rocket.style.display='block';
    function moveRocket(){
      const vw = window.innerWidth, vh = window.innerHeight;
      const x = Math.random()*(vw-120) + 40;
      const y = Math.random()*(vh-260) + 40;
      rocket.animate([{ transform: `translate(${x}px, ${y}px) rotate(${Math.random()*360}deg)` }], {duration:3000 + Math.random()*4000, fill:'forwards'});
    }
    setInterval(moveRocket, 3600);
    moveRocket();

    // CORE: fixed items array
    const itemsData = [
      {id:'plastic', emoji:'üß¥', en:'plastic bottle', pt:'garrafa pl√°stica', type:'plastics'},
      {id:'banana', emoji:'üçå', en:'banana peel', pt:'casca de banana', type:'organic'},
      {id:'paper', emoji:'üì∞', en:'paper', pt:'papel', type:'paper'},
      {id:'can', emoji:'ü•´', en:'can', pt:'lata', type:'metal'},
      {id:'glass', emoji:'ü•É', en:'glass', pt:'vidro', type:'glass'}
    ];

    const translations = {
      en:{ title:'Clean Park ‚Äî Recycling Game', lead:'Fun, colorful and safe way to learn recycling words in English.', gameTitle:'Game 1 ‚Äî Sort & Learn', instructions:'Drag each item to the correct recycling bin. Say the new word out loud!', vocab:'plastic bottle, paper, banana peel, can, glass', reset:'Reset', play:'Play Word', translation:'Portugu√™s', score:'Score:', found:'Found:', level:'Level', quizTitle:'Mini-Quiz', quizSubtitle:'Choose the correct word for the image shown.', tips:['Repeat the words out loud with the child.','Give a small reward for each correct sort.','Play the "Play Word" button and ask them to point.'] },
      pt:{ title:'Parque Limpo ‚Äî Jogo de Reciclagem', lead:'Divertido, colorido e seguro para aprender palavras de reciclagem em ingl√™s.', gameTitle:'Jogo 1 ‚Äî Separe e Aprenda', instructions:'Arraste cada item para a lixeira correta. Diga a palavra em voz alta!', vocab:'garrafa pl√°stica, papel, casca de banana, lata, vidro', reset:'Redefinir', play:'Ouvir', translation:'Portugu√™s', score:'Pontua√ß√£o:', found:'Encontrados:', level:'N√≠vel', quizTitle:'Mini-Quiz', quizSubtitle:'Escolha a palavra correta para a imagem mostrada.', tips:['Repita as palavras em voz alta com a crian√ßa.','D√™ uma pequena recompensa para cada separa√ß√£o correta.','Toque o bot√£o "Ouvir" e pe√ßa para apontar.'] }
    };

    // DOM refs
    const itemsEl = document.getElementById('items');
    const bins = Array.from(document.querySelectorAll('.bin'));
    const scoreEl = document.getElementById('score');
    const foundCountEl = document.getElementById('foundCount');
    const totalItemsEl = document.getElementById('totalItems');

    let score = 0, found = 0;
    let currentLang = 'en';

    // render items (no native draggable ‚Äî we use pointer events)
    function renderItems(){
      itemsEl.innerHTML = '';
      itemsData.forEach(it => {
        const node = document.createElement('div');
        node.className = 'item';
        node.id = it.id;
        node.dataset.type = it.type;
        node.dataset.en = it.en;
        node.dataset.pt = it.pt;

        node.innerHTML = `
          <div class="emoji">${it.emoji}</div>
          <div class="label">${it.en}</div>
          <button class="playBtn" aria-label="play ${it.en}">${translations.en.play}</button>
        `;

        itemsEl.appendChild(node);

        // Pointer events for drag (works on touch and mouse)
        node.addEventListener('pointerdown', pointerStart);
        node.querySelector('.playBtn').addEventListener('click', ()=> speak(it.en));
      });
      totalItemsEl.textContent = itemsData.length;
    }

    // pointer-based drag implementation
    let dragging = null; // {el, clone, pointerId, offsetX, offsetY}
    function pointerStart(e){
      // only left button or touch
      if(e.button !== undefined && e.button !== 0) return;
      const el = e.currentTarget;
      el.setPointerCapture(e.pointerId);
      const rect = el.getBoundingClientRect();
      const offsetX = e.clientX - rect.left;
      const offsetY = e.clientY - rect.top;

      const clone = el.cloneNode(true);
      clone.style.position = 'fixed';
      clone.style.left = (e.clientX - offsetX) + 'px';
      clone.style.top = (e.clientY - offsetY) + 'px';
      clone.style.zIndex = 9999;
      clone.style.pointerEvents = 'none';
      clone.style.width = rect.width + 'px';
      clone.style.height = rect.height + 'px';
      clone.style.opacity = '0.95';
      document.body.appendChild(clone);

      dragging = { el, clone, pointerId: e.pointerId, offsetX, offsetY };

      function moveHandler(ev){
        if(!dragging || ev.pointerId !== dragging.pointerId) return;
        dragging.clone.style.left = (ev.clientX - dragging.offsetX) + 'px';
        dragging.clone.style.top = (ev.clientY - dragging.offsetY) + 'px';

        // highlight bins when hovering
        bins.forEach(b => {
          const bRect = b.getBoundingClientRect();
          const cRect = dragging.clone.getBoundingClientRect();
          if(!(cRect.right < bRect.left || cRect.left > bRect.right || cRect.bottom < bRect.top || cRect.top > bRect.bottom)){
            b.classList.add('highlight');
          } else {
            b.classList.remove('highlight');
          }
        });
      }

      function upHandler(ev){
        if(!dragging || ev.pointerId !== dragging.pointerId) return;
        // find intersected bin
        const cRect = dragging.clone.getBoundingClientRect();
        const drop = bins.find(b => {
          const bRect = b.getBoundingClientRect();
          return !(cRect.right < bRect.left || cRect.left > bRect.right || cRect.bottom < bRect.top || cRect.top > bRect.bottom);
        });

        if(drop){
          handleDrop(dragging.el, drop);
        }

        // cleanup
        bins.forEach(b => b.classList.remove('highlight'));
        try{ dragging.el.releasePointerCapture(dragging.pointerId); } catch(e){}
        document.removeEventListener('pointermove', moveHandler);
        document.removeEventListener('pointerup', upHandler);
        if(dragging.clone && dragging.clone.parentElement) dragging.clone.remove();
        dragging = null;
      }

      document.addEventListener('pointermove', moveHandler);
      document.addEventListener('pointerup', upHandler);
    }

    function handleDrop(node, bin){
      if(!node || !bin) return;
      const expected = bin.dataset.type;
      const actual = node.dataset.type;
      if(expected === actual){
        // success animation + remove
        node.style.transition = 'transform .25s ease, opacity .25s ease';
        node.style.opacity = 0.15;
        node.style.transform = 'scale(.9)';
        // remove node from DOM after small delay
        setTimeout(()=> {
          if(node.parentElement) node.remove();
        }, 260);
        score += 10; found += 1;
      } else {
        // shake
        node.animate([{transform:'translateX(0)'},{transform:'translateX(-8px)'},{transform:'translateX(8px)'},{transform:'translateX(0)'}], {duration:360});
        score = Math.max(0, score-2);
      }
      updateUI();
      speak(node.dataset.en);
    }

    function updateUI(){ const txt = translations[currentLang].score; scoreEl.innerText = `${txt} ${score}`; foundCountEl.textContent = found; }

    document.getElementById('resetBtn').addEventListener('click', ()=>{ score=0; found=0; renderItems(); updateUI(); });
    document.getElementById('voiceBtn').addEventListener('click', ()=>{ const pick = itemsData[Math.floor(Math.random()*itemsData.length)]; speak(pick.en); });

    function speak(text){ if(!window.speechSynthesis) return; const t = new SpeechSynthesisUtterance(text); t.lang = 'en-US'; speechSynthesis.cancel(); speechSynthesis.speak(t); }

    // quiz (simple)
    const quizImage = document.getElementById('quizImage');
    const quizBtns = document.querySelectorAll('.quizBtn');
    const quizFeedback = document.getElementById('quizFeedback');
    let currentQuiz = {emoji:'üçå',answer:'banana'};
    function newQuiz(){ const pick = itemsData[Math.floor(Math.random()*itemsData.length)]; currentQuiz.emoji = pick.emoji; currentQuiz.answer = pick.en.split(' ')[0]; quizImage.textContent = pick.emoji; const options = [currentQuiz.answer,'paper','plastic'].sort(()=>Math.random()-0.5); quizBtns.forEach((b,i)=>{ b.textContent = options[i]; b.disabled=false; b.style.opacity=1; b.style.background=''; }); quizFeedback.textContent=''; }
    quizBtns.forEach(b=> b.addEventListener('click', ()=>{ const pick = b.textContent.trim(); if(pick === currentQuiz.answer){ quizFeedback.textContent = 'Great! ‚úÖ'; b.style.backgroundColor = 'var(--accent-2)'; score += 5; found += 1; updateUI(); } else { quizFeedback.textContent = 'Try again! ‚ùå'; b.style.backgroundColor = 'rgba(255,80,80,0.9)'; score = Math.max(0, score-1); updateUI(); } setTimeout(()=>{ quizBtns.forEach(x=> x.style.backgroundColor=''); newQuiz(); },900); }));

    // translation toggle
    const transToggle = document.getElementById('transToggle');
    transToggle.addEventListener('change', ()=>{
      currentLang = transToggle.checked ? 'pt' : 'en';
      applyTranslation();
    });

    function applyTranslation(){ const lang = translations[currentLang]; document.getElementById('title').innerText = lang.title; document.getElementById('lead').innerText = lang.lead; document.getElementById('gameTitle').innerText = lang.gameTitle; document.getElementById('instructions').innerText = lang.instructions; document.getElementById('vocabList').innerText = lang.vocab; document.getElementById('resetBtn').innerText = lang.reset; document.getElementById('voiceBtn').innerText = lang.play; document.getElementById('transLabel').innerText = lang.translation; document.getElementById('score').innerText = `${lang.score} ${score}`; document.getElementById('levelLabel').innerText = lang.level; document.getElementById('quizTitle').innerText = lang.quizTitle; document.getElementById('quizSubtitle').innerText = lang.quizSubtitle; document.getElementById('tip1').innerText = lang.tips[0]; document.getElementById('tip2').innerText = lang.tips[1]; document.getElementById('tip3').innerText = lang.tips[2];
      // bins
      document.getElementById('bin-plastics-label').innerText = currentLang==='pt' ? 'Pl√°sticos' : 'Plastics';
      document.getElementById('bin-plastics-hint').innerText = currentLang==='pt' ? 'garrafas, embalagens' : 'bottles, packaging';
      document.getElementById('bin-paper-label').innerText = currentLang==='pt' ? 'Papel' : 'Paper';
      document.getElementById('bin-paper-hint').innerText = currentLang==='pt' ? 'cart√µes, papel' : 'cards, paper';
      document.getElementById('bin-organic-label').innerText = currentLang==='pt' ? 'Org√¢nico' : 'Organic';
      document.getElementById('bin-organic-hint').innerText = currentLang==='pt' ? 'comida, casca' : 'food, peel';
      document.getElementById('bin-metal-label').innerText = currentLang==='pt' ? 'Metal' : 'Metal';
      document.getElementById('bin-metal-hint').innerText = currentLang==='pt' ? 'latas' : 'cans, tins';

      // items labels and play buttons
      document.querySelectorAll('.item').forEach(el=>{
        const id = el.id; const data = itemsData.find(x=> x.id === id);
        if(!data) return;
        el.querySelector('.label').innerText = currentLang==='pt' ? data.pt : data.en;
        el.querySelector('.playBtn').innerText = lang.play;
        // update play action
        el.querySelector('.playBtn').onclick = ()=> speak(data.en);
      });

      // vocab list
      document.getElementById('vocabList').innerText = lang.vocab;
    }

    // CONFETTI implementation (canvas) - kept as in other file
    (function initConfetti(){
      const confettiCanvas = document.createElement('canvas');
      confettiCanvas.id = 'confettiCanvas';
      confettiCanvas.style.position = 'fixed';
      confettiCanvas.style.left = 0;
      confettiCanvas.style.top = 0;
      confettiCanvas.style.width = '100%';
      confettiCanvas.style.height = '100%';
      confettiCanvas.style.pointerEvents = 'none';
      document.body.appendChild(confettiCanvas);
      const ctx = confettiCanvas.getContext('2d');
      let W = confettiCanvas.width = window.innerWidth, H = confettiCanvas.height = window.innerHeight;
      window.addEventListener('resize', ()=>{ W = confettiCanvas.width = window.innerWidth; H = confettiCanvas.height = window.innerHeight; });

      window.bigCelebrate = function(){
        const pieces = [];
        for(let i=0;i<80;i++){ pieces.push({ x: W/2, y: H/3, vx:(Math.random()-0.5)*8, vy:(Math.random()-1.5)*8, r: Math.random()*6+2, c: ['#ff595e','#ffca3a','#8ac926','#1982c4','#6a4c93'][Math.floor(Math.random()*5)] }); }
        let t=0;
        function run(){ ctx.clearRect(0,0,W,H); t+=1; pieces.forEach(p=>{ p.x += p.vx; p.y += p.vy; p.vy += 0.25; p.vx *= 0.99; ctx.fillStyle=p.c; ctx.beginPath(); ctx.ellipse(p.x,p.y,p.r, p.r*0.6, 0,0,Math.PI*2); ctx.fill(); }); if(t<180) requestAnimationFrame(run); else ctx.clearRect(0,0,W,H); }
        run();
      };
    })();

    // init
    renderItems(); applyTranslation(); updateUI(); newQuiz();

  </script>
</body>
</html>
